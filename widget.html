<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ë¡±ìˆ TOP 5 ìœ„ì ¯</title>
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
<style>
:root {
  --bg: #08080d;
  --bg-card: #101018;
  --border: #1c1c2e;
  --text: #e8e8f0;
  --muted: #555570;
  --green: #00d68f;
  --red: #ff3d71;
}
* { margin:0; padding:0; box-sizing:border-box; }
body { background: var(--bg); color: var(--text); font-family: 'Noto Sans KR', sans-serif; }

.widget {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 10px;
  padding: 12px;
  max-width: 600px;
}

.box {
  background: var(--bg-card);
  border: 1px solid var(--border);
  border-radius: 8px;
  padding: 12px 14px;
}

.box h3 {
  font-size: 12px;
  font-weight: 600;
  margin-bottom: 8px;
}
.box.long-box h3 { color: var(--green); }
.box.short-box h3 { color: var(--red); }

.item {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 5px 0;
  border-bottom: 1px solid #1c1c2e60;
  font-size: 12px;
}
.item:last-child { border-bottom: none; }

.item .left {
  display: flex;
  align-items: center;
  gap: 6px;
}
.item img { width: 16px; height: 16px; border-radius: 50%; }
.item .sym { font-family: 'JetBrains Mono', monospace; font-weight: 600; font-size: 12px; }

.item .pct {
  font-family: 'JetBrains Mono', monospace;
  font-weight: 600;
  font-size: 12px;
}
.long-box .pct { color: var(--green); }
.short-box .pct { color: var(--red); }

.footer {
  text-align: center;
  font-size: 9px;
  color: var(--muted);
  padding: 6px;
}

@media (max-width: 400px) {
  .widget { grid-template-columns: 1fr; }
}
</style>
</head>
<body>

<div class="widget" id="widget">
  <div class="box long-box">
    <h3>ğŸŸ¢ ë¡± ê³¼ë°€ TOP 5</h3>
    <div id="longList">ë¡œë”© ì¤‘...</div>
  </div>
  <div class="box short-box">
    <h3>ğŸ”´ ìˆ ê³¼ë°€ TOP 5</h3>
    <div id="shortList">ë¡œë”© ì¤‘...</div>
  </div>
</div>
<div class="footer">Binance ê¸€ë¡œë²Œ ë¡±ìˆ ë¹„ìœ¨ ê¸°ì¤€ Â· ìë™ ì—…ë°ì´íŠ¸</div>

<script>
async function load() {
  try {
    const resp = await fetch('data/coins.json');
    const data = await resp.json();
    const coins = data.coins.filter(c => c.binance?.global_account?.long);
    const sorted = [...coins].sort((a, b) =>
      b.binance.global_account.long - a.binance.global_account.long
    );

    const topLong = sorted.slice(0, 5);
    const topShort = sorted.slice(-5).reverse();

    document.getElementById('longList').innerHTML = topLong.map(c => {
      const p = (c.binance.global_account.long * 100).toFixed(1);
      return `<div class="item"><div class="left"><img src="${c.image}" onerror="this.style.display='none'"><span class="sym">${c.symbol}</span></div><span class="pct">${p}%</span></div>`;
    }).join('');

    document.getElementById('shortList').innerHTML = topShort.map(c => {
      const p = ((1 - c.binance.global_account.long) * 100).toFixed(1);
      return `<div class="item"><div class="left"><img src="${c.image}" onerror="this.style.display='none'"><span class="sym">${c.symbol}</span></div><span class="pct">${p}%</span></div>`;
    }).join('');
  } catch (e) {
    document.getElementById('longList').textContent = 'ë¡œë”© ì‹¤íŒ¨';
    document.getElementById('shortList').textContent = 'ë¡œë”© ì‹¤íŒ¨';
  }
}

load();

// Auto-height for iframe
function postHeight() {
  const h = document.documentElement.scrollHeight;
  window.parent.postMessage({ type: 'resize', height: h }, '*');
  window.parent.postMessage({ height: h }, '*');
}
new ResizeObserver(() => postHeight()).observe(document.body);
window.addEventListener('load', () => setTimeout(postHeight, 300));
</script>
</body>
</html>
