<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Î°±Ïàè ÎπÑÏú® ÎåÄÏãúÎ≥¥Îìú | Herdvibe</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;600;700;900&family=JetBrains+Mono:wght@400;500;600;700&family=Plus+Jakarta+Sans:wght@400;500;600;700;800&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
<script src="https://t1.kakaocdn.net/kakao_js_sdk/2.7.1/kakao.min.js" crossorigin="anonymous" async></script>
<style>
:root {
  --hv-primary:#3b82f6;--hv-primary-light:#60a5fa;--hv-primary-dark:#2563eb;
  --hv-primary-glow:rgba(59,130,246,0.12);
  --hv-up:#22c55e;--hv-up-bg:rgba(34,197,94,0.1);
  --hv-down:#ef4444;--hv-down-bg:rgba(239,68,68,0.1);
  --hv-warning:#f59e0b;--hv-neutral:#6b7280;
  --hv-bg-base:#000;--hv-bg-surface:#0a0a0a;--hv-bg-card:#111;
  --hv-bg-card-hover:#181818;--hv-bg-elevated:#1a1a1a;
  --hv-text-primary:#e5e5e5;--hv-text-secondary:#8a8a8a;
  --hv-text-tertiary:#555;--hv-text-muted:#3a3a3a;
  --hv-border:rgba(255,255,255,0.06);--hv-border-strong:rgba(255,255,255,0.12);
  --hv-font-display:'Plus Jakarta Sans',sans-serif;
  --hv-font-body:'Noto Sans KR',-apple-system,BlinkMacSystemFont,sans-serif;
  --hv-font-mono:'JetBrains Mono','SF Mono',monospace;
  --hv-space-xs:8px;--hv-space-sm:12px;--hv-space-md:16px;
  --hv-space-lg:24px;--hv-space-xl:32px;
  --hv-radius-sm:6px;--hv-radius-md:10px;--hv-radius-lg:14px;
  --hv-shadow-sm:0 1px 3px rgba(0,0,0,.5);--hv-shadow-lg:0 8px 32px rgba(0,0,0,.7);
  --hv-transition-fast:150ms ease;--hv-transition:250ms ease;
  --hv-max-width:1280px;--hv-header-height:56px;
  --blue:#4a9eff;--cyan:#00e5cc;--green:#00d68f;--red:#ff3d71;--orange:#ff8c42;--purple:#a855f7;
}
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
html{font-size:16px;scroll-behavior:smooth;-webkit-font-smoothing:antialiased;overflow-x:hidden}
body{font-family:var(--hv-font-body);background:var(--hv-bg-base);color:var(--hv-text-primary);line-height:1.6;overflow-x:hidden;overflow-y:auto;scrollbar-width:none;-ms-overflow-style:none}
body::-webkit-scrollbar{display:none}
a{color:var(--hv-primary-light);text-decoration:none}
::selection{background:var(--hv-primary);color:#fff}

.hv-header{position:sticky;top:0;z-index:100;height:var(--hv-header-height);background:rgba(0,0,0,.9);backdrop-filter:blur(20px) saturate(180%);-webkit-backdrop-filter:blur(20px) saturate(180%);border-bottom:1px solid var(--hv-border);display:flex;align-items:center;padding:0 var(--hv-space-lg)}
.hv-header-inner{width:100%;max-width:var(--hv-max-width);margin:0 auto;display:grid;grid-template-columns:1fr auto 1fr;align-items:center}
.hv-header-center{display:flex;flex-direction:column;align-items:center;text-align:center;min-width:0}
.hv-header-center h1{font-family:var(--hv-font-display);font-size:1.3rem;font-weight:600;color:var(--hv-text-primary);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.hv-header-category{font-size:.7rem;color:var(--hv-text-tertiary);font-weight:500;text-transform:uppercase;letter-spacing:.08em}
.hv-header-right{display:flex;align-items:center;justify-content:flex-end;gap:var(--hv-space-xs);flex-shrink:0}
.hv-update-badge{font-family:var(--hv-font-mono);font-size:.688rem;color:var(--hv-text-tertiary);white-space:nowrap;display:flex;align-items:center;gap:6px}
.hv-live-dot{width:5px;height:5px;background:var(--hv-up);border-radius:50%;animation:pulse 2s infinite}
@keyframes pulse{0%,100%{opacity:1}50%{opacity:.3}}

.hv-page{max-width:var(--hv-max-width);margin:0 auto;padding:var(--hv-space-lg)}
.dash-grid{display:grid;grid-template-columns:repeat(12,1fr);gap:14px}
.card{background:var(--hv-bg-card);border:1px solid var(--hv-border);border-radius:var(--hv-radius-lg);padding:18px 20px 16px;position:relative;overflow:visible;animation:fadeUp .5s ease both}
@keyframes fadeUp{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}
.card-label{font-family:var(--hv-font-mono);font-size:10px;font-weight:500;color:var(--hv-text-muted);text-transform:uppercase;letter-spacing:1.5px;margin-bottom:4px;text-align:center}
.card-title{font-size:15px;font-weight:700;margin-bottom:2px;display:flex;align-items:center;justify-content:center;gap:7px}
.card-desc{font-size:11.5px;color:var(--hv-text-secondary);margin-bottom:14px;line-height:1.5;text-align:center}
.s12{grid-column:span 12}

.status-bar{display:flex;gap:14px;font-size:10px;color:var(--hv-text-tertiary);flex-wrap:wrap;justify-content:center}
.ok{color:var(--green)}.ld{color:var(--orange)}.fl{color:var(--red)}

/* MAJOR GRID */
.major-grid{display:grid;grid-template-columns:repeat(5,1fr);gap:10px}
.major-card{background:rgba(255,255,255,.02);border:1px solid var(--hv-border);border-radius:8px;padding:12px;cursor:pointer;transition:all .2s;text-align:center}
.major-card:hover{border-color:var(--hv-border-strong);transform:translateY(-1px)}
.major-card.selected{border-color:var(--cyan);background:rgba(0,229,204,.04)}
.major-card .mc-sym{font-family:var(--hv-font-mono);font-weight:700;font-size:14px;margin-bottom:6px;display:flex;align-items:center;justify-content:center;gap:6px}
.major-card .mc-sym img{width:18px;height:18px;border-radius:50%}
.major-card .mc-row{display:flex;justify-content:space-between;font-size:11px;padding:2px 0}
.major-card .mc-label{color:var(--hv-text-tertiary)}
.major-card .mc-val{font-family:var(--hv-font-mono);font-weight:600}

/* TABS */
.tabs{display:flex;gap:4px;margin-bottom:14px;justify-content:center}
.tab{padding:6px 16px;border:1px solid var(--hv-border);border-radius:6px;font-family:var(--hv-font-mono);font-size:12px;color:var(--hv-text-secondary);cursor:pointer;transition:all .2s}
.tab:hover{border-color:var(--hv-border-strong);color:var(--hv-text-primary)}
.tab.active{background:var(--blue);color:#fff;border-color:var(--blue);font-weight:600}

/* CHART */
.chart-wrap{position:relative;width:100%;height:420px}
.chart-wrap canvas{width:100%!important;height:100%!important}
.chart-header{display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:10px;margin-bottom:14px}
.chart-coin{display:flex;align-items:center;gap:10px;font-size:16px;font-weight:700}
.chart-coin img{width:24px;height:24px;border-radius:50%}
.chart-stats{display:flex;gap:16px;font-size:12px}
.chart-stats .st{display:flex;flex-direction:column;align-items:center}
.chart-stats .sl{font-size:10px;color:var(--hv-text-tertiary)}
.chart-stats .sv{font-family:var(--hv-font-mono);font-weight:600;font-size:13px}

/* TABLE */
.search-wrap{position:relative;margin-bottom:14px}
.search-input{width:100%;padding:10px 14px 10px 38px;background:var(--hv-bg-elevated);border:1px solid var(--hv-border);border-radius:8px;color:var(--hv-text-primary);font-size:14px;font-family:var(--hv-font-body);outline:none;transition:border-color .2s}
.search-input:focus{border-color:var(--blue)}
.search-input::placeholder{color:var(--hv-text-tertiary)}
.search-icon{position:absolute;left:12px;top:50%;transform:translateY(-50%);color:var(--hv-text-tertiary);font-size:14px;pointer-events:none}
.search-count{font-size:11px;color:var(--hv-text-tertiary);margin-top:6px}
.twrap{overflow-x:auto;-webkit-overflow-scrolling:touch}
.ctable{width:100%;border-collapse:collapse;min-width:700px}
.ctable th{padding:10px 12px;font-size:11px;font-weight:600;color:var(--hv-text-secondary);letter-spacing:.3px;border-bottom:1px solid var(--hv-border);text-align:right;white-space:nowrap;cursor:pointer;user-select:none}
.ctable th:first-child{text-align:center;width:30px}.ctable th:nth-child(2){text-align:left}
.ctable th:hover{color:var(--hv-text-primary);background:var(--hv-bg-elevated)}
.ctable th.sorted{color:var(--blue)}
.sort-icon{font-size:10px;margin-left:2px;opacity:.3}
.ctable th.sorted .sort-icon{opacity:1;color:var(--blue)}
.ctable td{padding:10px 12px;border-bottom:1px solid var(--hv-border);text-align:right;font-family:var(--hv-font-mono);font-size:13px;white-space:nowrap}
.ctable td:first-child{text-align:center;color:var(--hv-text-muted);font-size:11px}
.ctable td:nth-child(2){text-align:left;font-family:var(--hv-font-body)}
.ctable tr:hover td{background:var(--hv-bg-card-hover)}
.ctable tr{cursor:pointer}
.coin-cell{display:flex;align-items:center;gap:8px}
.coin-cell img{width:22px;height:22px;border-radius:50%}
.coin-cell .sym{font-family:var(--hv-font-mono);font-weight:600;font-size:13px}
.coin-cell .name{color:var(--hv-text-secondary);font-size:11px;margin-left:4px}
.long-pct{color:var(--green);font-weight:500}
.ls-bar{display:flex;align-items:center;gap:4px}
.ls-bar .bar-track{width:60px;height:5px;background:rgba(255,61,113,.12);border-radius:3px;overflow:hidden}
.ls-bar .bar-long{height:100%;background:var(--green);border-radius:3px 0 0 3px;transition:width .4s}
.signal-badge{display:inline-block;padding:2px 8px;border-radius:4px;font-size:10px;font-weight:600;font-family:var(--hv-font-body)}
.signal-badge.extreme_long{background:rgba(0,214,143,.15);color:var(--green)}
.signal-badge.long{background:rgba(0,214,143,.08);color:#33e0a8}
.signal-badge.extreme_short{background:rgba(255,61,113,.15);color:var(--red)}
.signal-badge.short{background:rgba(255,61,113,.08);color:#ff6b8a}
.signal-badge.neutral{background:transparent;color:var(--hv-text-muted)}
.lc{color:var(--hv-text-muted);font-size:11px;font-style:italic}

.loading{display:flex;align-items:center;justify-content:center;height:120px;color:var(--hv-text-tertiary);font-size:13px}
.spinner{width:16px;height:16px;border:2px solid var(--hv-border);border-top-color:var(--blue);border-radius:50%;animation:spin .8s linear infinite;margin-right:10px}
@keyframes spin{to{transform:rotate(360deg)}}

/* SHARE BAR */
.share-bar{display:flex;align-items:center;justify-content:space-between;padding:12px var(--hv-space-lg);border-top:1px solid var(--hv-border);background:var(--hv-bg-surface);border-radius:0 0 var(--hv-radius-lg) var(--hv-radius-lg)}
.share-bar-preview{font-size:.75rem;color:var(--hv-text-tertiary);overflow:hidden;text-overflow:ellipsis;white-space:nowrap;max-width:50%;line-height:1.4;font-family:var(--hv-font-mono)}
.share-bar-preview span{color:var(--hv-text-secondary);font-weight:500}
.share-bar-buttons{display:flex;align-items:center;gap:6px;flex-shrink:0}
.share-btn{display:inline-flex;align-items:center;gap:6px;padding:7px 14px;border-radius:6px;font-size:.75rem;font-weight:600;font-family:var(--hv-font-body);cursor:pointer;transition:all var(--hv-transition-fast);border:1px solid var(--hv-border-strong);background:var(--hv-bg-card);color:#999;white-space:nowrap}
.share-btn:hover{transform:translateY(-1px);box-shadow:var(--hv-shadow-sm);color:var(--hv-text-primary)}
.share-btn svg{flex-shrink:0}
.share-btn--x:hover{border-color:#fff;color:#fff;background:#111}
.share-btn--kakao:hover{border-color:#FEE500;color:#191919;background:#FEE500}
.share-btn--tg:hover{border-color:#26A5E4;color:#fff;background:rgba(38,165,228,.15)}
.share-btn--ig:hover{border-color:#E4405F;color:#fff;background:rgba(228,64,95,.15)}
.share-btn--copy:hover{border-color:var(--hv-primary);color:var(--hv-primary-light);background:var(--hv-primary-glow)}
.toast-wrap{position:fixed;bottom:20px;right:20px;z-index:200;display:flex;flex-direction:column;gap:8px}
.toast{background:var(--hv-bg-elevated);border:1px solid var(--hv-border-strong);border-radius:var(--hv-radius-md);padding:10px 18px;font-size:.788rem;color:var(--hv-text-primary);box-shadow:var(--hv-shadow-lg);animation:toastIn .3s ease;border-left:3px solid var(--hv-up)}
@keyframes toastIn{from{opacity:0;transform:translateY(12px)}to{opacity:1;transform:translateY(0)}}

@media(max-width:1024px){.major-grid{grid-template-columns:repeat(3,1fr)}}
@media(max-width:768px){
  :root{--hv-header-height:52px}
  .hv-page{padding:var(--hv-space-md)}.hv-header{padding:0 var(--hv-space-md)}
  .hv-update-badge{display:none}.dash-grid{gap:10px}
  .card{padding:14px 14px 12px}.card-title{font-size:14px}
  .hv-header-center h1{font-size:1.1rem}
  .major-grid{grid-template-columns:repeat(2,1fr)}
  .chart-wrap{height:340px}
  .share-bar{flex-direction:column;gap:10px;align-items:stretch}
  .share-bar-preview{max-width:100%}
  .share-bar-buttons{justify-content:center;flex-wrap:wrap}
  .share-btn span.label-text{display:none}.share-btn{padding:8px 10px}
}
@media(max-width:520px){.hv-page{padding:12px 10px 24px}.chart-wrap{height:300px}}
@media(max-width:380px){.hv-header-center h1{font-size:1rem}}
</style>
</head>
<body>

<header class="hv-header">
  <div class="hv-header-inner">
    <div></div>
    <div class="hv-header-center">
      <h1>Î°±Ïàè ÎπÑÏú® ÎåÄÏãúÎ≥¥Îìú</h1>
      <span class="hv-header-category">Long/Short ¬∑ Full Dashboard</span>
    </div>
    <div class="hv-header-right">
      <div class="hv-update-badge"><span class="hv-live-dot"></span><span id="countdown">30s</span></div>
    </div>
  </div>
</header>

<div class="hv-page">
  <div class="dash-grid">

    <!-- STATUS -->
    <div class="card s12">
      <div class="card-label">DATA STATUS</div>
      <div class="card-title">Îç∞Ïù¥ÌÑ∞ Ïó∞Í≤∞ ÏÉÅÌÉú</div>
      <div class="status-bar">
        <span>ÏΩîÏù∏Î™©Î°ù: <span id="sCoins" class="ld">¬∑¬∑¬∑</span></span>
        <span>Binance: <span id="sBn" class="ld">¬∑¬∑¬∑</span></span>
        <span>Bybit: <span id="sBy" class="ld">¬∑¬∑¬∑</span></span>
      </div>
    </div>

    <!-- MAJOR 5 -->
    <div class="card s12">
      <div class="card-label">MAJOR COINS</div>
      <div class="card-title">Î©îÏù¥Ï†Ä ÏΩîÏù∏ Î°±Ïàè</div>
      <div class="card-desc">BTC, ETH, XRP, BNB, SOL ‚Äî ÌÅ¥Î¶≠ÌïòÎ©¥ Ï∞®Ìä∏ Ï†ÑÌôò</div>
      <div class="major-grid" id="majorGrid"></div>
    </div>

    <!-- CHART -->
    <div class="card s12" id="chartCard">
      <div class="card-label">LONG/SHORT HISTORY</div>
      <div class="card-title">Î°±Ïàè ÎπÑÏú® Ï∂îÏù¥</div>
      <div class="card-desc">ÏΩîÏù∏Î≥Ñ Î°±/Ïàè Í≥ÑÏ†ï ÎπÑÏú® ÌûàÏä§ÌÜ†Î¶¨</div>
      <div class="tabs" id="periodTabs">
        <div class="tab active" data-period="1">1Ïùº</div>
        <div class="tab" data-period="7">1Ï£º</div>
        <div class="tab" data-period="30">1Îã¨</div>
      </div>
      <div class="chart-header" id="chartHeader"></div>
      <div class="chart-wrap"><canvas id="mainChart"></canvas></div>
      <div class="share-bar" style="margin-top:14px;border-top:1px solid var(--hv-border);border-radius:0">
        <div class="share-bar-preview"><span>Î°±Ïàè Ï∂îÏù¥ Ï∞®Ìä∏</span> ‚Äî herdvibe.com</div>
        <div class="share-bar-buttons">
          <button class="share-btn share-btn--x" onclick="doShare('twitter')"><svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/></svg><span class="label-text">Ìä∏ÏúÑÌÑ∞</span></button>
          <button class="share-btn share-btn--kakao" onclick="doShare('kakao')"><svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor"><path d="M12 3C6.477 3 2 6.463 2 10.691c0 2.724 1.8 5.112 4.508 6.458l-1.148 4.265a.5.5 0 0 0 .764.533l4.94-3.26c.304.02.612.03.936.03 5.523 0 10-3.462 10-7.735C22 6.463 17.523 3 12 3z"/></svg><span class="label-text">Ïπ¥Ïπ¥Ïò§ÌÜ°</span></button>
          <button class="share-btn share-btn--tg" onclick="doShare('telegram')"><svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor"><path d="M11.944 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0zm4.962 7.224c.1-.002.321.023.465.14a.506.506 0 0 1 .171.325c.016.093.036.306.02.472-.18 1.898-.962 6.502-1.36 8.627-.168.9-.499 1.201-.82 1.23-.696.065-1.225-.46-1.9-.902-1.056-.693-1.653-1.124-2.678-1.8-1.185-.78-.417-1.21.258-1.91.177-.184 3.247-2.977 3.307-3.23.007-.032.014-.15-.056-.212s-.174-.041-.249-.024c-.106.024-1.793 1.14-5.061 3.345-.479.33-.913.49-1.302.48-.428-.008-1.252-.241-1.865-.44-.752-.245-1.349-.374-1.297-.789.027-.216.325-.437.893-.663 3.498-1.524 5.83-2.529 6.998-3.014 3.332-1.386 4.025-1.627 4.476-1.635z"/></svg><span class="label-text">ÌÖîÎ†àÍ∑∏Îû®</span></button>
          <button class="share-btn share-btn--ig" onclick="doShare('instagram',this)"><svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zM12 0C8.741 0 8.333.014 7.053.072 2.695.272.273 2.69.073 7.052.014 8.333 0 8.741 0 12c0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98C8.333 23.986 8.741 24 12 24c3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98C15.668.014 15.259 0 12 0zm0 5.838a6.162 6.162 0 100 12.324 6.162 6.162 0 000-12.324zM12 16a4 4 0 110-8 4 4 0 010 8zm6.406-11.845a1.44 1.44 0 100 2.881 1.44 1.44 0 000-2.881z"/></svg><span class="label-text">Ïù∏Ïä§ÌÉÄ</span></button>
          <button class="share-btn share-btn--copy" onclick="doShare('link',this)"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"/></svg><span class="label-text">ÎßÅÌÅ¨ Î≥µÏÇ¨</span></button>
        </div>
      </div>
    </div>

    <!-- FULL TABLE -->
    <div class="card s12">
      <div class="card-label">ALL COINS</div>
      <div class="card-title">Ï†ÑÏ≤¥ ÏΩîÏù∏ Î°±Ïàè ÎπÑÏú®</div>
      <div class="card-desc">Binance ¬∑ Bybit Ïã§ÏãúÍ∞Ñ Î°±/Ïàè ÎπÑÏú® ¬∑ ÏΩîÏù∏ÏùÑ ÌÅ¥Î¶≠ÌïòÎ©¥ Ï∞®Ìä∏ Ï†ÑÌôò</div>
      <div class="search-wrap">
        <span class="search-icon">üîç</span>
        <input type="text" class="search-input" id="coinSearch" placeholder="ÏΩîÏù∏ Í≤ÄÏÉâ (Ïù¥Î¶Ñ ÎòêÎäî Ïã¨Î≥º)" autocomplete="off">
        <div class="search-count" id="searchCount"></div>
      </div>
      <div class="twrap" id="tableWrap"><div class="loading"><div class="spinner"></div>Îç∞Ïù¥ÌÑ∞ Î°úÎî© Ï§ë...</div></div>
    </div>

  </div>

  <!-- BOTTOM SHARE BAR -->
  <div style="background:var(--hv-bg-card);border:1px solid var(--hv-border);border-radius:var(--hv-radius-lg);margin-top:var(--hv-space-lg);overflow:hidden">
    <div class="share-bar" style="border-top:none">
      <div class="share-bar-preview"><span>Î°±Ïàè ÎπÑÏú® ÎåÄÏãúÎ≥¥Îìú</span> ‚Äî herdvibe.com</div>
      <div class="share-bar-buttons">
        <button class="share-btn share-btn--x" onclick="doShare('twitter')"><svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/></svg><span class="label-text">Ìä∏ÏúÑÌÑ∞</span></button>
        <button class="share-btn share-btn--kakao" onclick="doShare('kakao')"><svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor"><path d="M12 3C6.477 3 2 6.463 2 10.691c0 2.724 1.8 5.112 4.508 6.458l-1.148 4.265a.5.5 0 0 0 .764.533l4.94-3.26c.304.02.612.03.936.03 5.523 0 10-3.462 10-7.735C22 6.463 17.523 3 12 3z"/></svg><span class="label-text">Ïπ¥Ïπ¥Ïò§ÌÜ°</span></button>
        <button class="share-btn share-btn--tg" onclick="doShare('telegram')"><svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor"><path d="M11.944 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0zm4.962 7.224c.1-.002.321.023.465.14a.506.506 0 0 1 .171.325c.016.093.036.306.02.472-.18 1.898-.962 6.502-1.36 8.627-.168.9-.499 1.201-.82 1.23-.696.065-1.225-.46-1.9-.902-1.056-.693-1.653-1.124-2.678-1.8-1.185-.78-.417-1.21.258-1.91.177-.184 3.247-2.977 3.307-3.23.007-.032.014-.15-.056-.212s-.174-.041-.249-.024c-.106.024-1.793 1.14-5.061 3.345-.479.33-.913.49-1.302.48-.428-.008-1.252-.241-1.865-.44-.752-.245-1.349-.374-1.297-.789.027-.216.325-.437.893-.663 3.498-1.524 5.83-2.529 6.998-3.014 3.332-1.386 4.025-1.627 4.476-1.635z"/></svg><span class="label-text">ÌÖîÎ†àÍ∑∏Îû®</span></button>
        <button class="share-btn share-btn--ig" onclick="doShare('instagram',this)"><svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zM12 0C8.741 0 8.333.014 7.053.072 2.695.272.273 2.69.073 7.052.014 8.333 0 8.741 0 12c0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98C8.333 23.986 8.741 24 12 24c3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98C15.668.014 15.259 0 12 0zm0 5.838a6.162 6.162 0 100 12.324 6.162 6.162 0 000-12.324zM12 16a4 4 0 110-8 4 4 0 010 8zm6.406-11.845a1.44 1.44 0 100 2.881 1.44 1.44 0 000-2.881z"/></svg><span class="label-text">Ïù∏Ïä§ÌÉÄ</span></button>
        <button class="share-btn share-btn--copy" onclick="doShare('link',this)"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"/></svg><span class="label-text">ÎßÅÌÅ¨ Î≥µÏÇ¨</span></button>
      </div>
    </div>
  </div>
</div>

<script>
/* ===== SHARE ===== */
var SHARE_URL='https://herdvibe.com/59';
function ensureKakao(){try{if(typeof Kakao!=='undefined'&&!Kakao.isInitialized())Kakao.init('a43ed7b39fac35458f4f9df925a279b5');return typeof Kakao!=='undefined'&&Kakao.isInitialized();}catch(e){return false;}}
ensureKakao();
function copyToClipboard(t){try{window.parent.postMessage({type:'clipboard',text:t},'*');}catch(e){}try{navigator.clipboard.writeText(t);}catch(e){}}
function flashCopied(btn){if(!btn)return;var o=btn.innerHTML;btn.style.background='#22c55e';btn.style.color='#fff';btn.style.borderColor='#22c55e';var hl=btn.querySelector('.label-text');btn.innerHTML='<svg width="13" height="13" viewBox="0 0 24 24" fill="none" stroke="#fff" stroke-width="3" stroke-linecap="round"><path d="M5 13l4 4L19 7"/></svg>'+(hl?'<span class="label-text" style="color:#fff">Î≥µÏÇ¨Îê®!</span>':'');setTimeout(function(){btn.style.background='';btn.style.color='';btn.style.borderColor='';btn.innerHTML=o;},2000);}
function doShare(p,btn){var u=SHARE_URL,t=encodeURIComponent('Î°±Ïàè ÎπÑÏú® ÎåÄÏãúÎ≥¥Îìú | herdvibe.com'),eu=encodeURIComponent(u);switch(p){case'twitter':window.open('https://twitter.com/intent/tweet?text='+t+'&url='+eu,'_blank');break;case'telegram':window.open('https://t.me/share/url?url='+eu+'&text='+t,'_blank');break;case'kakao':if(!ensureKakao()){copyToClipboard(u);toast('ÎßÅÌÅ¨ Î≥µÏÇ¨ÏôÑÎ£å!');}else try{Kakao.Share.sendDefault({objectType:'feed',content:{title:'Î°±Ïàè ÎπÑÏú® ÎåÄÏãúÎ≥¥Îìú',description:'Binance¬∑Bybit Î°±Ïàè ÎπÑÏú® Ï†ÑÏ≤¥ ÏΩîÏù∏ Î∂ÑÏÑù',imageUrl:'https://raw.githubusercontent.com/kittycapital/kittycapital.github.io/main/assets/herdvibe-og.png',link:{mobileWebUrl:u,webUrl:u}},buttons:[{title:'ÎåÄÏãúÎ≥¥Îìú Î≥¥Í∏∞',link:{mobileWebUrl:u,webUrl:u}}]});}catch(e){copyToClipboard(u);toast('ÎßÅÌÅ¨ Î≥µÏÇ¨ÏôÑÎ£å!');}break;case'instagram':copyToClipboard(u);flashCopied(btn);toast('ÎßÅÌÅ¨ Î≥µÏÇ¨ÏôÑÎ£å! Ïù∏Ïä§ÌÉÄÍ∑∏Îû®Ïóê Î∂ôÏó¨ÎÑ£Í∏∞ ÌïòÏÑ∏Ïöî');break;case'link':copyToClipboard(u);flashCopied(btn);toast('ÎßÅÌÅ¨Í∞Ä Î≥µÏÇ¨ÎêòÏóàÏäµÎãàÎã§ ‚úì');break;}}
function toast(m){var c=document.querySelector('.toast-wrap');if(!c){c=document.createElement('div');c.className='toast-wrap';document.body.appendChild(c);}var t=document.createElement('div');t.className='toast';t.textContent=m;c.appendChild(t);setTimeout(function(){t.style.opacity='0';t.style.transform='translateY(12px)';t.style.transition='.3s';setTimeout(function(){t.remove();},300);},3000);}

/* ===== CHART WATERMARK ===== */
var watermarkPlugin={id:'herdvibeWatermark',beforeDraw:function(chart){var ctx=chart.ctx,a=chart.chartArea;if(!a)return;var cx=(a.left+a.right)/2,cy=(a.top+a.bottom)/2;ctx.save();ctx.font='700 38px "Plus Jakarta Sans",sans-serif';ctx.fillStyle='rgba(255,255,255,0.035)';ctx.textAlign='center';ctx.textBaseline='middle';ctx.fillText('Herdvibe.com',cx,cy);ctx.restore();}};
Chart.register(watermarkPlugin);

/* ===== DATA ===== */
var allCoins=[],binanceData={},bybitData={},binanceDone=false,bybitDone=false;
var selectedCoin='BTC',mainChart=null,refreshTimer=30;
var MAJORS=['BTC','ETH','XRP','BNB','SOL'];
var currentSort={col:'market_cap_rank',dir:'asc'};
var searchQuery='';

function getBest(sym){
  var bn=binanceData[sym],by=bybitData[sym];
  if(bn&&by)return{long:(bn.long+by.long)/2,short:(bn.short+by.short)/2,src:'both'};
  if(bn)return{long:bn.long,short:bn.short,src:'binance'};
  if(by)return{long:by.long,short:by.short,src:'bybit'};
  return null;
}
function getSignal(longPct){
  if(longPct>=0.70)return{cls:'extreme_long',text:'Í∑πÎã® Î°±'};
  if(longPct>=0.60)return{cls:'long',text:'Î°± Í≥ºÎ∞Ä'};
  if(longPct<=0.30)return{cls:'extreme_short',text:'Í∑πÎã® Ïàè'};
  if(longPct<=0.40)return{cls:'short',text:'Ïàè Í≥ºÎ∞Ä'};
  return{cls:'neutral',text:'-'};
}

async function loadCoins(){
  try{var r=await fetch('data/coins.json?t='+Date.now());var d=await r.json();allCoins=d.coins||[];
    document.getElementById('sCoins').textContent='‚úì '+allCoins.length+'Í∞ú';document.getElementById('sCoins').className='ok';return true;
  }catch(e){document.getElementById('sCoins').textContent='‚úó Ïã§Ìå®';document.getElementById('sCoins').className='fl';return false;}
}

/* BINANCE */
async function fetchBinance(sym){
  try{var r=await fetch('https://fapi.binance.com/futures/data/globalLongShortAccountRatio?symbol='+sym+'USDT&period=1h&limit=1');
    if(!r.ok)return null;var d=await r.json();if(d&&d.length>0)return{long:+d[0].longAccount,short:+d[0].shortAccount};
  }catch(e){}return null;
}
async function fetchBinanceHistory(sym,period,limit){
  try{var r=await fetch('https://fapi.binance.com/futures/data/globalLongShortAccountRatio?symbol='+sym+'USDT&period='+period+'&limit='+limit);
    if(!r.ok)return[];var d=await r.json();return d.map(function(x){return{timestamp:new Date(x.timestamp).toISOString(),long:+x.longAccount,short:+x.shortAccount};});
  }catch(e){return[];}
}

/* BYBIT */
async function fetchBybit(sym){
  try{var r=await fetch('https://api.bybit.com/v5/market/account-ratio?category=linear&symbol='+sym+'USDT&period=1h&limit=1');
    if(!r.ok)return null;var d=await r.json();if(d.retCode===0){var l=d.result?.list;if(l&&l.length>0)return{long:+l[0].buyRatio,short:+l[0].sellRatio};}
  }catch(e){}return null;
}
async function fetchBybitHistory(sym,period,limit){
  try{var r=await fetch('https://api.bybit.com/v5/market/account-ratio?category=linear&symbol='+sym+'USDT&period='+period+'&limit='+limit);
    if(!r.ok)return[];var d=await r.json();if(d.retCode===0){var l=d.result?.list||[];return l.map(function(x){return{timestamp:new Date(+x.timestamp).toISOString(),long:+x.buyRatio,short:+x.sellRatio};}).reverse();}
  }catch(e){}return[];
}

async function fetchAllExchange(coins,fetchFn,store,statusId){
  var el=document.getElementById(statusId);el.textContent='0/'+coins.length;el.className='ld';var ok=0;
  for(var i=0;i<coins.length;i+=5){
    var batch=coins.slice(i,i+5);
    var results=await Promise.all(batch.map(function(c){return fetchFn(c.symbol);}));
    results.forEach(function(r,j){if(r){store[batch[j].symbol]=r;ok++;}});
    el.textContent=Math.min(i+5,coins.length)+'/'+coins.length;rerender();
    if(i+5<coins.length)await new Promise(function(res){setTimeout(res,250);});
  }
  el.textContent=ok>0?'‚úì '+ok+'Í∞ú':'‚úó Ï∞®Îã®';el.className=ok>0?'ok':'fl';
  return ok>0;
}

/* ===== RENDER ===== */
function rerender(){renderMajors();renderTable();sendHeight();}

function renderMajors(){
  var html='';
  MAJORS.forEach(function(sym){
    var coin=allCoins.find(function(c){return c.symbol===sym;});
    var bn=binanceData[sym],by=bybitData[sym];
    var sel=selectedCoin===sym?'selected':'';
    html+='<div class="major-card '+sel+'" onclick="selectCoin(\''+sym+'\')">'
      +'<div class="mc-sym">'+(coin?'<img src="'+coin.image+'" onerror="this.style.display=\'none\'">':'')+sym+'</div>'
      +'<div class="mc-row"><span class="mc-label">Binance</span><span class="mc-val long-pct">'+(bn?(bn.long*100).toFixed(1)+'%':'‚Äî')+'</span></div>'
      +'<div class="mc-row"><span class="mc-label">Bybit</span><span class="mc-val long-pct">'+(by?(by.long*100).toFixed(1)+'%':'‚Äî')+'</span></div>'
      +'</div>';
  });
  document.getElementById('majorGrid').innerHTML=html||'<div class="loading">Î©îÏù¥Ï†Ä ÏΩîÏù∏ Îç∞Ïù¥ÌÑ∞ ÏóÜÏùå</div>';
}

/* TABLE */
function renderTable(){
  var coins=allCoins.slice();
  if(searchQuery){var q=searchQuery.toLowerCase();coins=coins.filter(function(c){return c.symbol.toLowerCase().includes(q)||(c.name||'').toLowerCase().includes(q);});}
  coins=sortCoins(coins,currentSort.col,currentSort.dir);
  var countEl=document.getElementById('searchCount');
  countEl.textContent=searchQuery?coins.length+'Í∞ú ÏΩîÏù∏ Í≤ÄÏÉâÎê®':'';

  var si=function(c){return currentSort.col===c?'<span class="sort-icon">'+(currentSort.dir==='asc'?' ‚Üë':' ‚Üì')+'</span>':'<span class="sort-icon"> ‚Üï</span>';};
  var sc=function(c){return currentSort.col===c?'sorted':'';};
  var h='<table class="ctable"><thead><tr>'
    +'<th onclick="doSort(\'market_cap_rank\')" class="'+sc('market_cap_rank')+'">#'+si('market_cap_rank')+'</th>'
    +'<th onclick="doSort(\'symbol\')" class="'+sc('symbol')+'">ÏΩîÏù∏'+si('symbol')+'</th>'
    +'<th onclick="doSort(\'binance_long\')" class="'+sc('binance_long')+'">Binance'+si('binance_long')+'</th>'
    +'<th onclick="doSort(\'bybit_long\')" class="'+sc('bybit_long')+'">Bybit'+si('bybit_long')+'</th>'
    +'<th>Î°±/Ïàè</th>'
    +'<th onclick="doSort(\'signal\')" class="'+sc('signal')+'">ÏãúÍ∑∏ÎÑê'+si('signal')+'</th>'
    +'</tr></thead><tbody>';

  coins.forEach(function(c,i){
    var bn=binanceData[c.symbol],by=bybitData[c.symbol],best=getBest(c.symbol);
    var barLong=best?best.long:0.5;var sig=getSignal(best?best.long:0.5);
    h+='<tr onclick="selectCoin(\''+c.symbol+'\')">'
      +'<td>'+(c.market_cap_rank||i+1)+'</td>'
      +'<td><div class="coin-cell"><img src="'+c.image+'" onerror="this.style.display=\'none\'"><span class="sym">'+c.symbol+'</span><span class="name">'+(c.name||'')+'</span></div></td>'
      +'<td>'+(bn?'<span class="long-pct">'+(bn.long*100).toFixed(1)+'%</span>':(!binanceDone?'<span class="lc">¬∑¬∑¬∑</span>':'<span class="lc">-</span>'))+'</td>'
      +'<td>'+(by?'<span class="long-pct">'+(by.long*100).toFixed(1)+'%</span>':(!bybitDone?'<span class="lc">¬∑¬∑¬∑</span>':'<span class="lc">-</span>'))+'</td>'
      +'<td><div class="ls-bar"><div class="bar-track"><div class="bar-long" style="width:'+(barLong*100)+'%"></div></div></div></td>'
      +'<td><span class="signal-badge '+(best?sig.cls:'neutral')+'">'+(best?sig.text:'-')+'</span></td>'
      +'</tr>';
  });
  h+='</tbody></table>';
  if(!coins.length)h='<div class="loading" style="height:60px">Í≤ÄÏÉâ Í≤∞Í≥ºÍ∞Ä ÏóÜÏäµÎãàÎã§</div>';
  document.getElementById('tableWrap').innerHTML=h;
}

document.getElementById('coinSearch').addEventListener('input',function(){searchQuery=this.value.trim();renderTable();});

function sortCoins(coins,col,dir){
  return coins.sort(function(a,b){
    var va,vb;
    switch(col){
      case'market_cap_rank':va=a.market_cap_rank||999;vb=b.market_cap_rank||999;break;
      case'symbol':return dir==='asc'?a.symbol.localeCompare(b.symbol):b.symbol.localeCompare(a.symbol);
      case'binance_long':va=binanceData[a.symbol]?.long||0.5;vb=binanceData[b.symbol]?.long||0.5;break;
      case'bybit_long':va=bybitData[a.symbol]?.long||0.5;vb=bybitData[b.symbol]?.long||0.5;break;
      case'signal':va=Math.abs((getBest(a.symbol)?.long||0.5)-0.5);vb=Math.abs((getBest(b.symbol)?.long||0.5)-0.5);break;
      default:va=0;vb=0;
    }
    return dir==='asc'?va-vb:vb-va;
  });
}
function doSort(col){
  if(currentSort.col===col)currentSort.dir=currentSort.dir==='asc'?'desc':'asc';
  else{currentSort.col=col;currentSort.dir=col==='market_cap_rank'?'asc':'desc';}
  renderTable();
}

/* ===== CHART ===== */
async function selectCoin(sym){
  selectedCoin=sym;renderMajors();
  var coin=allCoins.find(function(c){return c.symbol===sym;});
  var bn=binanceData[sym],by=bybitData[sym];

  document.getElementById('chartHeader').innerHTML='<div class="chart-coin">'
    +(coin?'<img src="'+coin.image+'" onerror="this.style.display=\'none\'">':'')+sym+' Î°±Ïàè Ï∂îÏù¥</div>'
    +'<div class="chart-stats">'
    +'<div class="st"><span class="sl">Binance Î°±</span><span class="sv long-pct">'+(bn?(bn.long*100).toFixed(1)+'%':'-')+'</span></div>'
    +'<div class="st"><span class="sl">Bybit Î°±</span><span class="sv long-pct">'+(by?(by.long*100).toFixed(1)+'%':'-')+'</span></div>'
    +'</div>';

  var periodDays=parseInt(document.querySelector('.tab.active').dataset.period);
  var limit=periodDays<=1?24:periodDays<=7?42:250;
  var period=periodDays<=1?'1h':'4h';

  var bnHist=await fetchBinanceHistory(sym,period,limit);
  var byHist=await fetchBybitHistory(sym,period,limit);
  var hist=bnHist.length>0?bnHist:byHist;
  var histSrc=bnHist.length>0?'Binance':'Bybit';

  if(hist.length===0){document.querySelector('.chart-wrap').innerHTML='<div class="loading">ÌûàÏä§ÌÜ†Î¶¨ Îç∞Ïù¥ÌÑ∞Í∞Ä ÏóÜÏäµÎãàÎã§</div>';return;}

  if(!document.getElementById('mainChart')){document.querySelector('.chart-wrap').innerHTML='<canvas id="mainChart"></canvas>';}

  var cutoff=new Date();cutoff.setDate(cutoff.getDate()-periodDays);
  var filtered=hist.filter(function(h){return new Date(h.timestamp)>=cutoff;});
  var labels=filtered.map(function(h){var d=new Date(h.timestamp);return(d.getMonth()+1)+'/'+d.getDate()+' '+String(d.getHours()).padStart(2,'0')+':00';});

  if(mainChart)mainChart.destroy();
  mainChart=new Chart(document.getElementById('mainChart'),{
    type:'line',
    data:{labels:labels,datasets:[
      {label:histSrc+' Î°±',data:filtered.map(function(h){return h.long*100;}),borderColor:'#00d68f',backgroundColor:'rgba(0,214,143,0.08)',fill:true,tension:0.3,pointRadius:0,pointHoverRadius:4,borderWidth:2},
      {label:histSrc+' Ïàè',data:filtered.map(function(h){return h.short*100;}),borderColor:'#ff3d71',backgroundColor:'rgba(255,61,113,0.08)',fill:true,tension:0.3,pointRadius:0,pointHoverRadius:4,borderWidth:2},
      {label:'50% Í∏∞Ï§ÄÏÑ†',data:filtered.map(function(){return 50;}),borderColor:'rgba(255,255,255,0.25)',borderWidth:1.5,borderDash:[5,5],pointRadius:0,pointHoverRadius:0,fill:false}
    ]},
    options:{
      responsive:true,maintainAspectRatio:false,
      interaction:{intersect:false,mode:'index'},
      plugins:{
        legend:{labels:{color:'#8a8a8a',font:{family:"'Noto Sans KR',sans-serif",size:11},boxWidth:10,padding:14,filter:function(item){return item.text!=='50% Í∏∞Ï§ÄÏÑ†';}}},
        tooltip:{backgroundColor:'rgba(10,10,10,0.95)',titleColor:'#e5e5e5',bodyColor:'#8a8a8a',borderColor:'rgba(255,255,255,0.08)',borderWidth:1,cornerRadius:6,padding:10,
          callbacks:{label:function(it){return it.dataset.label+': '+it.raw.toFixed(1)+'%';}}}
      },
      scales:{
        x:{grid:{color:'rgba(255,255,255,0.03)',drawBorder:false},ticks:{color:'#888',font:{family:"'JetBrains Mono',monospace",size:10},maxRotation:0,autoSkip:true,maxTicksLimit:8}},
        y:{grid:{color:'rgba(255,255,255,0.03)',drawBorder:false},ticks:{color:'#888',font:{family:"'JetBrains Mono',monospace",size:10},callback:function(v){return v+'%';}},min:20,max:80}
      }
    }
  });
  document.getElementById('chartCard').scrollIntoView({behavior:'smooth',block:'start'});
  sendHeight();
}

/* PERIOD TABS */
document.querySelectorAll('.tab').forEach(function(tab){
  tab.addEventListener('click',function(){
    document.querySelector('.tab.active').classList.remove('active');
    tab.classList.add('active');
    if(selectedCoin)selectCoin(selectedCoin);
  });
});

/* ===== INIT ===== */
async function refresh(){
  binanceData={};bybitData={};binanceDone=false;bybitDone=false;
  await loadCoins();
  var bnP=fetchAllExchange(allCoins,fetchBinance,binanceData,'sBn').then(function(){binanceDone=true;rerender();});
  var byP=fetchAllExchange(allCoins,fetchBybit,bybitData,'sBy').then(function(){bybitDone=true;rerender();});
  Promise.all([bnP,byP]).then(function(){selectCoin(selectedCoin);});
  refreshTimer=30;
}

async function init(){
  await refresh();
  setInterval(function(){refreshTimer--;document.getElementById('countdown').textContent=refreshTimer+'s';if(refreshTimer<=0)refresh();},1000);
}

/* IFRAME RESIZE */
var _lastH=0,_ht,_frameId='hvLongshortAll';
function sendHeight(){clearTimeout(_ht);_ht=setTimeout(function(){var h=document.documentElement.scrollHeight;if(Math.abs(h-_lastH)>5){_lastH=h;window.parent.postMessage({type:'resize',height:h,id:_frameId},'*');window.parent.postMessage({height:h,id:_frameId},'*');}},150);}
window.addEventListener('resize',sendHeight);
window.addEventListener('load',function(){sendHeight();setTimeout(sendHeight,500);setTimeout(sendHeight,1500);setTimeout(sendHeight,3000);});
new MutationObserver(sendHeight).observe(document.body,{childList:true,subtree:true});
setInterval(sendHeight,2000);

init();
</script>
</body>
</html>
